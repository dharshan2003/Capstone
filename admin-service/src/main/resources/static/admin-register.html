<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MyFinBank | Admin Register</title>
    <style>
        body { margin:0; font-family:Arial,sans-serif; background:#020617; color:#e5e7eb; }
        .container { max-width:420px; margin:60px auto; background:#0f172a; padding:24px 28px;
            border-radius:12px; box-shadow:0 18px 40px rgba(0,0,0,0.8); }
        h2 { margin-top:0; margin-bottom:16px; }
        label { display:block; font-size:13px; margin-top:10px; margin-bottom:4px; color:#9ca3af; }
        input { width:100%; padding:8px 10px; border-radius:8px; border:1px solid #4b5563;
            background:#020617; color:#e5e7eb; font-size:13px; }
        button { margin-top:16px; width:100%; padding:9px 0; border-radius:999px; border:none;
            font-size:14px; font-weight:600; cursor:pointer;
            background:linear-gradient(135deg,#22c55e,#4ade80); color:#020617; }
        .link { margin-top:10px; font-size:12px; }
        .link a { color:#93c5fd; text-decoration:none; }
        .msg { margin-top:10px; font-size:12px; min-height:16px; }
        .error { color:#f97373; }
        .success { color:#4ade80; }
    </style>
</head>
<body>
<div class="container">
    <h2>Admin Registration</h2>

    <label>Display Name</label>
    <input id="displayName" type="text" placeholder="Admin User">

    <label>Email</label>
    <input id="email" type="email" placeholder="admin@example.com">

    <label>Login Name</label>
    <input id="loginName" type="text" placeholder="admin123">

    <label>Password</label>
    <input id="loginSecret" type="password" placeholder="••••••••">

    <button id="registerBtn">Create Admin</button>

    <div class="msg" id="msg"></div>

    <div class="link">
        Already registered? <a href="/admin-login.html">Login here</a>
    </div>
</div>

<script>
    const msg = document.getElementById('msg');

    document.getElementById('registerBtn').addEventListener('click', async () => {
        msg.textContent = '';
        msg.className = 'msg';

        const displayName = document.getElementById('displayName').value.trim();
        const email = document.getElementById('email').value.trim();
        const loginName = document.getElementById('loginName').value.trim();
        const loginSecret = document.getElementById('loginSecret').value.trim();

        if (!email || !loginName || !loginSecret) {
            msg.textContent = 'Email, login name and password are required.';
            msg.className = 'msg error';
            return;
        }

        try {
            const resp = await fetch('/api/auth/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: email,
                    password: loginSecret,
                    displayName: displayName,
                    loginName: loginName
                })
            });

            if (!resp.ok) {
                const errText = await resp.text().catch(() => '');
                msg.textContent = errText || 'Registration failed.';
                msg.className = 'msg error';
                return;
            }

            msg.textContent = 'Admin created successfully. Redirecting to login...';
            msg.className = 'msg success';

            setTimeout(() => {
                window.location.href = '/admin-login.html';
            }, 1200);

        } catch (e) {
            msg.textContent = 'Server error during registration.';
            msg.className = 'msg error';
        }
    });
</script>

</body>
</html>
